"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{e.exports=require("punycode")},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30246:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>m,routeModule:()=>y,serverHooks:()=>h,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>g});var o={};t.r(o),t.d(o,{OPTIONS:()=>l,POST:()=>x});var s=t(96559),n=t(48088),a=t(37719),i=t(32190),p=t(73488),u=t(22563),c=t(8898);function d(e){return e.headers.set("Access-Control-Allow-Origin","*"),e.headers.set("Access-Control-Allow-Methods","GET, POST, OPTIONS"),e.headers.set("Access-Control-Allow-Headers","Content-Type, Authorization"),e}async function l(){return d(new i.NextResponse(null,{status:204}))}async function x(e){try{let r;let t=e.clone(),o=await t.json();if(console.log("Request body:",o),!o.targetType||!o.scriptId||!o.location||!o.version)return d(i.NextResponse.json({error:"Missing required fields"},{status:400}));let s=await c.A.verifyAuth(e);if(!s)return console.error("Authentication failed:",s),d(i.NextResponse.json({error:"Unauthorized",details:s||"Authentication failed"},{status:401}));let n=new u.WebflowClient({accessToken:s}),a=new p.Y(n),l=await c.A.getSiteIdFromAccessToken(s);if(!l)return console.error("SiteId not found:",l),d(i.NextResponse.json({error:"Unauthorized",details:l||"SiteId failed"},{status:401}));if("site"===o.targetType)r=await a.upsertSiteCustomCode(l,o.scriptId,o.location,o.version);else{if("page"!==o.targetType)return d(i.NextResponse.json({error:"Invalid target type"},{status:400}));r=await a.upsertPageCustomCode(l,o.scriptId,o.location,o.version)}return d(i.NextResponse.json({result:r},{status:200}))}catch(e){if(e instanceof Error)return console.error("Error applying custom code:",e.message),d(i.NextResponse.json({error:"Failed to apply custom code",details:e.message},{status:500}));return console.error("Unknown error:",e),d(i.NextResponse.json({error:"Failed to apply custom code",details:"An unknown error occurred"},{status:500}))}}let y=new s.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/custom-code/apply/route",pathname:"/api/custom-code/apply",filename:"route",bundlePath:"app/api/custom-code/apply/route"},resolvedPagePath:"D:\\SearchApp\\search-server\\app\\api\\custom-code\\apply\\route.ts",nextConfigOutput:"standalone",userland:o}),{workAsyncStorage:f,workUnitAsyncStorage:g,serverHooks:h}=y;function m(){return(0,a.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:g})}},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},55591:e=>{e.exports=require("https")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{e.exports=require("zlib")},79551:e=>{e.exports=require("url")},81630:e=>{e.exports=require("http")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[297,190,563,595,149],()=>t(30246));module.exports=o})();